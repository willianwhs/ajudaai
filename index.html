<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AJUDAAI</title>

<style>
:root{
--amarelo:#FFC107;
--azul:#1E3A8A;
--cinza:#f4f6f8;
}

body{
margin:0;
font-family:Arial;
background:var(--cinza);
}

header{
background:#fff;
padding:25px;
text-align:center;
border-bottom:3px solid var(--amarelo);
}

h1{
margin:0;
font-size:32px;
font-weight:800;
}

.logo1{color:var(--azul)}
.logo2{color:var(--amarelo)}

.botaoTopo{
margin-top:10px;
padding:10px 16px;
border:none;
border-radius:8px;
background:var(--azul);
color:#fff;
font-weight:bold;
}

.cards{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
gap:20px;
padding:20px;
}

.card{
background:#fff;
padding:20px;
border-radius:14px;
text-align:center;
box-shadow:0 6px 18px rgba(0,0,0,0.08);
position:relative;
}

.selo{
position:absolute;
top:10px;
right:10px;
background:var(--azul);
color:#fff;
padding:4px 10px;
border-radius:20px;
font-size:12px;
}

.botao{
display:block;
margin-top:8px;
padding:10px;
border-radius:8px;
text-decoration:none;
font-weight:bold;
}

.whatsapp{
background:#25D366;
color:#fff;
}

.avaliar{
background:var(--azul);
color:#fff;
}
</style>
</head>

<body>

<header>
<h1><span class="logo1">AJUDA</span><span class="logo2">AI</span></h1>
<button class="botaoTopo" onclick="ativarLocalizacao()">üìç Perto de mim</button>
</header>

<div class="cards" id="lista"></div>

<script>

const URL_JSON="https://raw.githubusercontent.com/willianwhs/ajudaai/main/prestadores.json";

let prestadores=[];

fetch(URL_JSON)
.then(r=>r.json())
.then(d=>{
prestadores=d;
renderPrestadores(prestadores);
});

function calcularDistancia(lat1,lng1,lat2,lng2){
const R=6371;
const dLat=(lat2-lat1)*Math.PI/180;
const dLng=(lng2-lng1)*Math.PI/180;
const a=Math.sin(dLat/2)**2+
Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*
Math.sin(dLng/2)**2;
return R*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)));
}

function ativarLocalizacao(){
navigator.geolocation.getCurrentPosition(pos=>{

const userLat=pos.coords.latitude;
const userLng=pos.coords.longitude;

prestadores.forEach(p=>{
if(p.lat && p.lng){
p.distancia=calcularDistancia(userLat,userLng,p.lat,p.lng);
}
});

prestadores.sort((a,b)=>(a.distancia||999)-(b.distancia||999));

renderPrestadores(prestadores);

});
}

function renderPrestadores(lista){

const container=document.getElementById("lista");
container.innerHTML="";

lista.forEach(p=>{

const estrelas=p.media ? "‚≠ê".repeat(Math.round(p.media)) : "Sem avalia√ß√µes";
const distancia=p.distancia ? `üìç ${p.distancia.toFixed(1)} km` : "";

container.innerHTML+=`
<div class="card">

${p.verificado ? '<div class="selo">‚úî Verificado</div>' : ''}

<h3>${p.nome}</h3>
<div>${p.servico}</div>
<div>${p.cidade}</div>
<div>${estrelas}</div>
<div>${distancia}</div>

<a class="botao whatsapp" href="https://wa.me/55${p.whatsapp}" target="_blank">
WhatsApp
</a>

<a class="botao avaliar" href="#" target="_blank">
Avaliar
</a>

</div>
`;

});

}

</script>

</body>
</html>
